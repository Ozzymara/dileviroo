{% extends 'base.html' %}

{%block title%}üîê Login{%endblock title%}

{% block body %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous">
</script>

<div class="vh-100">
    <div class="container-fluid h-custom">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-md-9 col-lg-6 col-xl-5">
                <img src="static/logo.webp"
              class="img-fluid" alt="Dileviroo Logo" style="width: 80%; height: auto; max-height: 80%;">
            </div>
            <div class="col-md-8 col-lg-6 col-xl-4 offset-xl-1">

                {% for message in messages %}
                <div class="alert alert-primary alert-dismissable fade show" role="alert">
                    <strong>{{message}}</strong>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% endfor %}

                <form method="post" action="/login">
                    {% csrf_token %}

                    <!-- Username input -->
                    <div class="form-outline mb-4">

                        <input type="tel" id="form3Example3" name="phone" class="form-control form-control-lg" placeholder="Enter Mobile Number" maxlength="11">
                        <label class="form-label" for="form3Example3">Mobile Number</label>
                    </div>

                    <!-- Password input -->
                    <div class="form-outline mb-3">
                        <input type="password" id="form3Example4" name='password' class="form-control form-control-lg"
                  placeholder="Enter password">
                        <label class="form-label" for="form3Example4">Password</label>
                    </div>


                    <div class="text-center text-lg-start mt-4 pt-2">
                        <button type="submit" class="btn btn-primary btn-lg text-white"
        style="padding-left: 2.5rem; padding-right: 2.5rem;">
  Login
</button>

                        <p class="small fw-bold mt-2 pt-1 mb-0">Don't have an account? <a href="/signup"
                                class="link-danger">Register</a></p>
                    </div>

                </form>
            </div>
        </div>
    </div>

</div>

<script>
    /* global setTimeout, console */
document.addEventListener('DOMContentLoaded', function() {
    const passwordInput = document.querySelector('input[name="password"]');
    
    function showNotification(message, type = 'error') {
        const existing = document.querySelector('.field-notification');
        if (existing) existing.remove();
        
        const notification = document.createElement('div');
        notification.className = 'field-notification';
        notification.textContent = message;
        notification.style.cssText = `
            position: fixed; top: 20px; right: 20px; padding: 10px 15px;
            background: ${type === 'error' ? '#dc3545' : '#28a745'}; color: white;
            border-radius: 4px; z-index: 1000; font-size: 14px;
        `;
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 3000);
    }
    
    // Password validation - exactly 8 characters
    if (passwordInput) {
        passwordInput.addEventListener('input', function(e) {
            if (this.value.length > 8) {
                showNotification('Password cannot exceed 8 characters!');
                this.value = this.value.substring(0, 8);
            }
        });
        
        passwordInput.addEventListener('keydown', function(e) {
            if (this.value.length >= 8 && e.key !== 'Backspace' && e.key !== 'Delete' && e.key !== 'ArrowLeft' && e.key !== 'ArrowRight' && e.key !== 'Tab') {
                e.preventDefault();
                showNotification('Password cannot exceed 8 characters!');
            }
        });
    }
});
</script>

{% endblock %}